<meta content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no'
	name='viewport' />
<!-- <link href='https://fonts.googleapis.com/css?family=Josefin+Sans:100' rel='stylesheet' type='text/css'> -->
<!-- <link href='https://max.pub/css/base.css' rel='stylesheet' type='text/css'> -->
<link href='https://max.pub/css/josefin.css' rel='stylesheet' type='text/css'>

<style>
	/* *{font-weight: 300;;} */
	html {
		/* background: #1a1a1a; */
		/* color: #eee; */
		font-family: josefin;
		font-size: 25px;
		font-weight: 100
	}

	h1,
	h3 {
		font-weight: 300;
	}

	h3 {
		margin-top: 3rem;
	}

	a {
		text-decoration: none;
		color: black
	}

	main {
		width: 100%;
		max-width: 30rem;
		margin: 0 auto;

		padding: 1rem;
	}

	a:hover {
		color: cornflowerblue;
		cursor: pointer;
	}
</style>


<main>
	<h1>Gedichte</h1>

</main>

<script>
	/**
	 * Shuffles array in place. ES6 version
	 * @param {Array} a items An array containing the items.
	 */
	function shuffle(a) {
		for (let i = a.length - 1; i > 0; i--) {
			const j = Math.floor(Math.random() * (i + 1));
			[a[i], a[j]] = [a[j], a[i]];
		}
		return a;
	}

	(async function () {
		const data = await fetch('https://api.github.com/repos/max-pub/gedichte/contents/max/').then(x => x.json());
		const names = data.map(x => x.name)
		shuffle(names);
		// console.log(names);
		// let poems = {};
		let main = document.querySelector('main');
		for (let name of names) {
			let poem = await fetch('https://max.pub/gedichte/max/' + name).then(x => x.text());
			console.log('loaded', name, poem)
			let [title, snippet, full] = poem.split('\n\n\n\n')
			console.log(title, snippet)
			let html = `<a href='#${name.replace('.txt', '')}'><h3>${title}</h3><p>${snippet.replace(/\n/g, '<br/>')}</p></a>`;
			main.insertAdjacentHTML('beforeend', html);
		}

	})()
</script>